---
# route | grep '^default' | grep -o '[^ ]*$'
## to avoid dns issue (used in both client and server mode)
# get the IP address of the primary network interface
# this can be confused by multiple networks and schould testet !

- name: get icinga2 server ip address  # noqa 306
  shell: ip route ls | grep default | awk '{ print $3 }'
  changed_when: false
  register: _ipaddr

- name: set icinga2_master_ip
  set_fact:
    icinga2_master_ip: "{{ _ipaddr.stdout }}"
